{% extends "base.html" %}
{% block content %}
<div class="container mt-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2>ðŸ“° Blogs</h2>
    {% if current_user.is_authenticated %}
      <a href="{{ url_for('create_blog') }}" class="btn btn-primary btn-sm">âž• New Blog</a>
    {% endif %}
  </div>

  {% if blogs %}
    {% for blog in blogs %}
    <div class="card mb-3 shadow-sm">
      <div class="card-body">
        <h4><a href="{{ url_for('blog_detail', blog_id=blog.id) }}">{{ blog.title }}</a></h4>
        <p class="text-muted small">by {{ blog.author.username }} on {{ blog.date_posted.strftime('%Y-%m-%d') }}</p>
        <p>{{ blog.content[:200] }}{% if blog.content|length > 200 %}...{% endif %}</p>
        <a href="{{ url_for('blog_detail', blog_id=blog.id) }}" class="btn btn-outline-primary btn-sm">Read More</a>

        <!-- â¤ï¸ Like / Reaction Button -->
        {% if current_user.is_authenticated %}
        <form class="like-form d-inline mt-2" data-id="{{ blog.id }}" data-type="blog">
          <button type="button" class="btn btn-sm like-btn {% if blog.id in liked_blog_ids %}btn-danger{% else %}btn-outline-danger{% endif %}">
            <i class="bi bi-heart{% if blog.id in liked_blog_ids %}-fill{% endif %}"></i>
            <span class="like-count">{{ blog.likes|length }}</span>
          </button>
        </form>
        {% endif %}

      </div>
    </div>
    {% endfor %}
  {% else %}
    <p class="text-muted text-center mt-5">No blogs yet. Be the first to write one!</p>
  {% endif %}
</div>
{% endblock %}
